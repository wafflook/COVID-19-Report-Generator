(function t(e,n){if(typeof module==="object"&&typeof exports==="object")module.exports=n();else if(typeof define==="function"&&define.amd)define([],n);else e.VueLoader=n()})(this,(function t(){"use strict";var e=0;n.prototype={withBase:function(t){var e;if(this.component.baseURI){e=document.createElement("base");e.href=this.component.baseURI;var n=this.component.getHead();n.insertBefore(e,n.firstChild)}t.call(this);if(e)this.component.getHead().removeChild(e)},scopeStyles:function(t,e){function n(){var n=t.sheet;var i=n.cssRules;for(var s=0;s<i.length;++s){var r=i[s];if(r.type!==1)continue;var o=[];r.selectorText.split(/\s*,\s*/).forEach((function(t){o.push(e+" "+t);var n=t.match(/([^ :]+)(.+)?/);o.push(n[1]+e+(n[2]||""))}));var u=o.join(",")+r.cssText.substr(r.selectorText.length);n.deleteRule(s);n.insertRule(u,s)}}try{n()}catch(e){if(e instanceof DOMException&&e.code===DOMException.INVALID_ACCESS_ERR){t.sheet.disabled=true;t.addEventListener("load",(function e(){t.removeEventListener("load",e);setTimeout((function(){n();t.sheet.disabled=false}))}));return}throw e}},compile:function(){var t=this.template!==null;var e=this.elt.hasAttribute("scoped");if(e){if(!t)return;this.elt.removeAttribute("scoped")}this.withBase((function(){this.component.getHead().appendChild(this.elt)}));if(e)this.scopeStyles(this.elt,"["+this.component.getScopeId()+"]");return Promise.resolve()},getContent:function(){return this.elt.textContent},setContent:function(t){this.withBase((function(){this.elt.textContent=t}))}};function n(t,e){this.component=t;this.elt=e}i.prototype={getContent:function(){return this.elt.textContent},setContent:function(t){this.elt.textContent=t},compile:function(t){var e=function(t){return c.require(l(this.component.baseURI,t))}.bind(this);var n=function(t,e){return c(l(this.component.baseURI,t),e)}.bind(this);try{Function("exports","require","VueLoader","module",this.getContent()).call(this.module.exports,this.module.exports,e,n,this.module)}catch(t){if(!("lineNumber"in t)){return Promise.reject(t)}var i=responseText.replace(/\r?\n/g,"\n");var s=i.substr(0,i.indexOf(script)).split("\n").length+t.lineNumber-1;throw new t.constructor(t.message,url,s)}return Promise.resolve(this.module.exports).then(c.scriptExportsHandler.bind(this)).then(function(t){this.module.exports=t}.bind(this))}};function i(t,e){this.component=t;this.elt=e;this.module={exports:{}}}s.prototype={getContent:function(){return this.elt.innerHTML},setContent:function(t){this.elt.innerHTML=t},getRootElt:function(){var t=this.elt.content||this.elt;if("firstElementChild"in t)return t.firstElementChild;for(t=t.firstChild;t!==null;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE)return t;return null},compile:function(){return Promise.resolve()}};function s(t,e){this.component=t;this.elt=e}r.prototype={getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getScopeId:function(){if(this._scopeId===""){this._scopeId="data-s-"+(e++).toString(36);this.template.getRootElt().setAttribute(this._scopeId,"")}return this._scopeId},load:function(t){return c.httpRequest(t).then(function(e){this.baseURI=t.substr(0,t.lastIndexOf("/")+1);var r=document.implementation.createHTMLDocument("");r.body.innerHTML=(this.baseURI?'<base href="'+this.baseURI+'">':"")+e;for(var o=r.body.firstChild;o;o=o.nextSibling){switch(o.nodeName){case"TEMPLATE":this.template=new s(this,o);break;case"SCRIPT":this.script=new i(this,o);break;case"STYLE":this.styles.push(new n(this,o));break}}return this}.bind(this))},_normalizeSection:function(t){var e;if(t===null||!t.elt.hasAttribute("src")){e=Promise.resolve(null)}else{e=c.httpRequest(t.elt.getAttribute("src")).then((function(e){t.elt.removeAttribute("src");return e}))}return e.then(function(e){if(t!==null&&t.elt.hasAttribute("lang")){var n=t.elt.getAttribute("lang");t.elt.removeAttribute("lang");return c.langProcessor[n.toLowerCase()].call(this,e===null?t.getContent():e)}return e}.bind(this)).then((function(e){if(e!==null)t.setContent(e)}))},normalize:function(){return Promise.all(Array.prototype.concat(this._normalizeSection(this.template),this._normalizeSection(this.script),this.styles.map(this._normalizeSection))).then(function(){return this}.bind(this))},compile:function(){return Promise.all(Array.prototype.concat(this.template&&this.template.compile(),this.script&&this.script.compile(),this.styles.map((function(t){return t.compile()})))).then(function(){return this}.bind(this))}};function r(t){this.name=t;this.template=null;this.script=null;this.styles=[];this._scopeId=""}function o(t){return t}function u(t){var e=t.match(/(.*?)([^/]+?)\/?(\.vue|\.cfm)?(\?.*|#.*|$)/);return{name:e[2],url:e[1]+e[2]+(e[3]===undefined?"/index.vue":e[3])+e[4]}}function l(t,e){if(e.substr(0,2)==="./"||e.substr(0,3)==="../"){return t+e}return e}c.load=function(t,e){return function(){return new r(e).load(t).then((function(t){return t.normalize()})).then((function(t){return t.compile()})).then((function(t){var e=t.script!==null?t.script.module.exports:{};if(t.template!==null)e.template=t.template.getContent();if(e.name===undefined)if(t.name!==undefined)e.name=t.name;e._baseURI=t.baseURI;return e}))}};c.register=function(t,e){var n=u(e);t.component(n.name,c.load(n.url))};c.install=function(t){t.mixin({beforeCreate:function(){var e=this.$options.components;for(var n in e){if(typeof e[n]==="string"&&e[n].substr(0,4)==="url:"){var i=u(e[n].substr(4));var s="_baseURI"in this.$options?l(this.$options._baseURI,i.url):i.url;if(isNaN(n))e[n]=c.load(s,n);else e[n]=t.component(i.name,c.load(s,i.name))}}}})};c.require=function(t){return window[t]};c.httpRequest=function(t){return new Promise((function(e,n){var i=new XMLHttpRequest;i.open("GET",t);i.responseType="text";i.onreadystatechange=function(){if(i.readyState===4){if(i.status>=200&&i.status<300)e(i.responseText);else n(i.status)}};i.send(null)}))};c.langProcessor={html:o,js:o,css:o};c.scriptExportsHandler=o;function c(t,e){var n=u(t);return c.load(n.url,e)}return c}));